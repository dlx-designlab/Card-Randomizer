{% extends "base.html" %}

{% block content %}
    <div class="card_deal">
        {% if cards_folder == "rammojammo_cards" %}    
            <div class="card_deck_rammojammo">
                <img id="jammo_imageid_front" style="background: url({{ url_for('image.static', filename = cards_folder + '/card-1.jpg') }}) 0 0 / auto 400px" src="{{ url_for('image.static', filename = 'img_trans.gif') }}" alt="">
                <img id="jammo_imageid_back" style="background: url({{ url_for('image.static', filename = cards_folder + '/card-1.jpg') }}) -350px 0 / auto 400px" src="{{ url_for('image.static', filename = 'img_trans.gif') }}" alt="">
            </div>
        {% else %}
            <div class="card_deck">
                <img id="imageid" src="{{ url_for('image.static', filename = cards_folder + '/card-1.jpg') }}">
            </div>
        {% endif %}

        <p class="counter">
            <span id="count">1</span><span> / {{ cardsNum }}</span>
        </p>
        <div class="button">
            <button class="deal" onclick="randomize_image({{ cardsNum }}, '{{ cards_folder }}')">DEAL</button>
        </div>
    </div>
    
    <script>
        var cards_cache = [];
        randomize_image({{ cardsNum }}, '{{ cards_folder }}')

        /* NEW random generater : character_cards */
        function randomize_image(numOfCards, cards_folder) {
            //console.log(numOfCards)
            //console.log(cards_folder)
            if (cards_cache.length >= numOfCards) {
                alert("You have reached the end of the deck...!\nPress OK to shuffle the deck")
                cards_cache = [];
            } 
            while (true) {
                var r = Math.floor(Math.random() * numOfCards) + 1;
                if (cards_cache.indexOf(r) === -1) {
                    cards_cache.push(r);
                    break;
                }
            }
            var imgName = "card-" + r + ".jpg";
            var imgPath = "../../static/image/" + cards_folder + "/" + imgName
            if (cards_folder === "rammojammo_cards") {
                document.getElementById('jammo_imageid_front').style.background = "url("+ imgPath +") 0 0 / auto 400px"
                document.getElementById('jammo_imageid_back').style.background = "url("+ imgPath +") -350px 0 / auto 400px"
            } else {
                document.getElementById("imageid").src = imgPath; 
            }
            document.getElementById("count").innerHTML = cards_cache.length;
        } 
    </script>
{% endblock %}